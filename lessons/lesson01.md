# 01、基础架构
![mysql基础架构图](../pic/01.png)

## 1、mysql架构组成：server层 + 存储引擎层

    server层：连接器，分析器，优化器，执行器
    存储引擎层：InnoDB，MyISAM，Memory

## 2、连接器

    验证账号密码，维持链接，超时自动断开，链接过程复杂，建议使用长链接；
    连接比较占用内存，需要定时断开，5.7之后可使用 mysql_reset_connection 初始化连接。

## 3、分析器

    执行语法分析，验证语法的合规性，把sql转换成mysql内部识别的语句，表明转换成对应的id。

## 4、优化器

    判断使用哪个索引，判断sql内部的执行顺序，确定执行方案。

## 5、执行器

    先验证操作库表是否有权限，调用存储引擎接口查询数据，获得结果返回给客户端。
    
    如果ID没有索引：
	调用InnoDB引擎接口取这个表的第一行，判断ID值是不是10，如果不是则跳过，如果是则将这行存在结果集中；
	调用引擎接口取“下一行”，重复相同的判断逻辑，直到取到这个表的最后一行；
	执行器将上述遍历过程中所有满足条件的行组成的记录集作为结果集返回给客户端。

    如果ID有索引：
    第一次调用的是“取满足条件的第一行”这个接口，之后循环取“满足条件的下一行”这个接口

## 6、慢查询日志rows_examined

    记录执行器每次调用引擎接口进行查询的累计行数，相同表有可能次数不同。

